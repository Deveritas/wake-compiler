import Printer;
import System;

import Asserts;
import AssertsTest;
import MathTest;
import BooleanLogicTest;
import InheritanceTest;
import ArrayTest;
import OptionalTypeTest;
import AssignmentsTest;
import PropertyTest;
import AutoboxingTest;
import GenericTest;
import SimpleGeneric;

#>
# Test suite entry point
##
every Main is:

	needs System, AssertsTest, Printer, MathTest, BooleanLogicTest, InheritanceTest, ArrayTest, OptionalTypeTest, AssignmentsTest, PropertyTest, AutoboxingTest, GenericTest;

	provides Printer, Asserts,
		SimpleGeneric{Int, Text},
		SimpleGeneric{Text, Int},
		SimpleGeneric{SimpleGeneric{Int, Text}, SimpleGeneric{Text, Int}};

	with Bool passed = true;
	with Int totalcount = 0;
	with Int failedcount = 0;
	with Int passedcount = 0;
	with Text[] failed `tests by name` = [];

	run(Bool result, test Text) {
		totalcount += 1;
		if(!result) {
			failed[failedcount] = test;
			failedcount += 1;
			passed = false;
			Printer.print("F");
		} else {
			Printer.print(".");
			passedcount += 1;
		}
	}

	main() {
		run(AssertsTest.~[test assert text matches]~(), "test assert text matches");
		run(AssertsTest.~[test assert text not matches]~(), "test assert text not matches");
		run(AssertsTest.~[test assert int matches]~(), "test assert int matches");
		run(AssertsTest.~[test assert int not matches]~(), "test assert int not matches");
		run(AssertsTest.~[test assert true matches]~(), "test assert true matches");
		run(AssertsTest.~[test assert true not matches]~(), "test assert true not matches");
		run(AssertsTest.~[test assert false matches]~(), "test assert false matches");
		run(AssertsTest.~[test assert false not matches]~(), "test assert false not matches");
		run(AssertsTest.~[test assert true]~(), "test assert true");
		run(AssertsTest.~[test assert not true]~(), "test assert not true");
		run(AssertsTest.~[test assert false]~(), "test assert false");
		run(AssertsTest.~[test assert not false]~(), "test assert not false");
		run(MathTest.testAddition(Asserts <- this), "testAddition");
		run(MathTest.testSubtraction(Asserts <- this), "testSubtraction");
		run(MathTest.testDivision(Asserts <- this), "testDivision");
		run(MathTest.testMultiplication(Asserts <- this), "testMultiplication");
		run(MathTest.testOrderOfOperations(Asserts <- this), "testOrderOfOperations");
		run(BooleanLogicTest.testOr(Asserts <- this), "testOr");
		run(BooleanLogicTest.testAnd(Asserts <- this), "testAnd");
		run(BooleanLogicTest.testOrderOfOperations(Asserts <- this), "testOrderOfOperations");
		//Run(TernaryOperatorTest.testTrue(Asserts <- this));
		//Run(TernaryOperatorTest.testFalse(Asserts <- this));
		run(InheritanceTest.~[test parent gets parent class name]~(Asserts <- this), "test parentgets parent classname");
		run(InheritanceTest.~[test override child gets child class name]~(Asserts <- this), "test override child gets child classname");
		run(InheritanceTest.~[test override child from provider gets child class name]~(Asserts <- this), "test ovveride child from provider gets child class name");
		run(InheritanceTest.~[test override child after cast gets child class name]~(Asserts <- this), "test override child after cast gets child classname");
		run(InheritanceTest.~[test fallthrough child gets child class name]~(Asserts <- this ), "test fallthrough child gets child classname");
		run(InheritanceTest.~[test fallthrough child from provider gets child class name]~(Asserts <- this ), "test fallthrough child from provider gets child class name");
		run(InheritanceTest.~[test fallthrough child after cast gets child class name]~(Asserts <- this ), "test fallthrough child after cast gets child classname");
		run(InheritanceTest.~[test implementing child gets child class name]~(Asserts <- this ), "test implementing child gets child class name");
		run(InheritanceTest.~[test implementing child from provider gets child class name]~(Asserts <- this ), "test implementing child from proider gets child class name");
		run(InheritanceTest.~[test implementing child after cast gets child class name]~(Asserts <- this ), "test implementing child after cast gets child class name");
		run(InheritanceTest.~[test parent has need fulfilled]~(Asserts <- this ), "test parent has need fulfilled");
		run(InheritanceTest.~[test fallthrough has need fulfilled]~(Asserts <- this ), "test fallthrough has need fulfilled");
		run(InheritanceTest.~[test interface has need redefined]~(Asserts <- this ), "test interface has need redefined");
		run(ArrayTest.~[test set array index]~(Asserts <- this), "test set array index");
		run(ArrayTest.~[test reset array index]~(Asserts <- this), "test reset array index");
		run(ArrayTest.~[test set array array index index]~(Asserts <- this), "test set array array index index");
		run(ArrayTest.~[test reset array array index index]~(Asserts <- this), "tset reset array array index index");
		run(ArrayTest.~[test set multiple array indices]~(Asserts <- this), "test set multiple array indices");
		run(ArrayTest.~[test set multiple array array indices indices]~(Asserts <- this), "test set multiple array array indices indices");
		run(OptionalTypeTest.~[test optional int never set]~(), "test optional int never set");
		run(OptionalTypeTest.~[test optional int set]~(), "teest optional int set");
		run(OptionalTypeTest.~[test optional int not set will hit else]~(), "test optional int not set will hit else");
		run(OptionalTypeTest.~[test optional int set wont hit else]~(), "test optional int set wont hit else");
		run(AssignmentsTest.testPlusEquals(Asserts <- this), "testPlusEquals");
		run(AssignmentsTest.testMinusEquals(Asserts <- this), "testMinusEquals");
		run(AssignmentsTest.testTimesEquals(Asserts <- this), "testTimesEquals");
		run(AssignmentsTest.testDivideEquals(Asserts <- this), "testDivideEquals");
		run(AssignmentsTest.testUsingAssigmentReturnValues(Asserts <- this), "testUsingAssigmentReturnValues");
		run(PropertyTest.~[test own properties]~(Asserts <- this), "test own properties");
		run(PropertyTest.~[test others properties]~(Asserts <- this), "test others properties");
		run(AutoboxingTest.testIntSquared(Asserts <- this), "testIntSquared");
		run(AutoboxingTest.testAbsoluteValue(Asserts <- this), "testAbsoluteValue");
		run(AutoboxingTest.testMaxOfInt(Asserts <- this), "testMaxOfInt");
		run(AutoboxingTest.testMaxOfInts(Asserts <- this), "testMaxOfInts");
		run(AutoboxingTest.testMinOfInt(Asserts <- this), "testMinOfInt");
		run(AutoboxingTest.testMinOfInts(Asserts <- this), "testMinOfInts");
		run(AutoboxingTest.testNumberOfDigits(Asserts <- this), "testNumberOfDigits");
		run(AutoboxingTest.testToUpper(Asserts <- this), "testToUpper");
		run(AutoboxingTest.testToLower(Asserts <- this), "testToLower");
		run(AutoboxingTest.testSwitchCase(Asserts <- this), "testSwitchCase");
		run(AutoboxingTest.testTrim(Asserts <- this), "testSwitchCase");
		run(GenericTest.~[ test all start out as nothing in methods ]~(Asserts <- this), "test all start out as nothing in methods");
		run(GenericTest.~[ test get otherwise in methods ]~(Asserts <- this), "test get otherwise in methods");
		run(GenericTest.~[ test set and then get in methods ]~(Asserts <- this), "test set and then get in methods");
		run(GenericTest.~[ test unset and then all is nothing ]~(Asserts <- this), "test unset and then all is nothing");

		Printer.printLine("");
		Printer.printLine("");
		Printer.print("TOTAL:  ");
		Printer.printLine(totalcount);
		Printer.print("PASSED: ");
		Printer.printLine(passedcount);
		Printer.print("FAILED: ");
		Printer.printLine(failedcount);

		if(passed) System.exit(0);
		Printer.printLine("FAILURES:");

		var Int = 0;
		while(Int < failedcount) {
			Printer.printLine(failed[Int]);
			Int += 1;
		}

		System.exit(1);
	}

#>
every TernaryOperatorTest is:

	Bool -- testTrue() {
		return true ? true : false;
	}

	Bool -- testFalse() {
		return false ? false : true;
	}
##
